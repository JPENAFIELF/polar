<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Coordenadas Polares MR - Quest 3</title>
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/webxr/VRButton.js"></script>
</head>
<body style="margin:0; overflow:hidden;">
<script>
    // Crear escena mixta (passthrough)
    const scene = new THREE.Scene();

    // Cámara VR
    const camera = new THREE.PerspectiveCamera(70, window.innerWidth/window.innerHeight, 0.01, 1000);

    // Render con soporte WebXR + Passthrough
    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.xr.enabled = true;
    document.body.appendChild(renderer.domElement);
    document.body.appendChild(THREE.VRButton.createButton(renderer));

    //------------------------------------------
    //   CREAR MALLA DE COORDENADAS POLARES
    //------------------------------------------

    const polarGroup = new THREE.Group();

    // Círculos concéntricos
    for (let r = 0.5; r <= 5; r += 0.5) {
        const circleGeom = new THREE.CircleGeometry(r, 360);
        circleGeom.vertices.shift(); // quitar centro
        const circle = new THREE.LineLoop(
            new THREE.BufferGeometry().setFromPoints(circleGeom.vertices),
            new THREE.LineBasicMaterial({ color: 0x00ffff })
        );
        circle.rotation.x = -Math.PI / 2; // acostarlo en el piso
        polarGroup.add(circle);
    }

    // Líneas radiales cada 15°
    for (let deg = 0; deg < 360; deg += 15) {
        const rad = THREE.MathUtils.degToRad(deg);
        const x = 5 * Math.cos(rad);
        const z = 5 * Math.sin(rad);

        const points = [new THREE.Vector3(0, 0, 0), new THREE.Vector3(x, 0, z)];
        const geom = new THREE.BufferGeometry().setFromPoints(points);

        const line = new THREE.Line(
            geom,
            new THREE.LineBasicMaterial({ color: 0xff00aa })
        );
        polarGroup.add(line);
    }

    // Posicionar la malla en el suelo real
    polarGroup.position.set(0, -1.6, 0); // ajusta altura según necesidad
    scene.add(polarGroup);

    //------------------------------------------
    //   ANIMACIÓN
    //------------------------------------------
    renderer.setAnimationLoop(() => {
        renderer.render(scene, camera);
    });

</script>
</body>
</html>
