<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Coordenadas Polares AR - Quest 3</title>
<style>
    body { margin: 0; overflow: hidden; }
</style>

<!-- Three.js GLOBAL (NO MÃ“DULO) -->
<script src="https://threejs.org/docs/index.html#manual/en/introduction/Installation"></script>

<!-- ARButton GLOBAL (compatible con non-module) -->
<script src="https://cdn.jsdelivr.net/npm/three@0.150.1/examples/jsm/webxr/ARButton.js"></script>

</head>
<body>

<script>
const scene = new THREE.Scene();

const camera = new THREE.PerspectiveCamera(
    70,
    window.innerWidth / window.innerHeight,
    0.01,
    1000
);

const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.xr.enabled = true;
renderer.xr.setReferenceSpaceType("local-floor");
document.body.appendChild(renderer.domElement);

document.body.appendChild(
    ARButton.createButton(renderer, {
        requiredFeatures: ["local-floor"]
    })
);

// ==============================
// MALLA POLAR EN EL PISO
// ==============================
const polarGroup = new THREE.Group();

for (let r = 0.5; r <= 5; r += 0.5) {
    const pts = [];
    for (let deg = 0; deg < 360; deg++) {
        const rad = THREE.MathUtils.degToRad(deg);
        pts.push(new THREE.Vector3(
            r * Math.cos(rad),
            0,
            r * Math.sin(rad)
        ));
    }
    const geometry = new THREE.BufferGeometry().setFromPoints(pts);
    const material = new THREE.LineBasicMaterial({ color: 0x00ffff });
    polarGroup.add(new THREE.LineLoop(geometry, material));
}

for (let deg = 0; deg < 360; deg += 15) {
    const rad = THREE.MathUtils.degToRad(deg);
    const geometry = new THREE.BufferGeometry().setFromPoints([
        new THREE.Vector3(0, 0, 0),
        new THREE.Vector3(5 * Math.cos(rad), 0, 5 * Math.sin(rad))
    ]);
    const material = new THREE.LineBasicMaterial({ color: 0xff00aa });
    polarGroup.add(new THREE.Line(geometry, material));
}

scene.add(polarGroup);

renderer.setAnimationLoop(() => renderer.render(scene, camera));
</script>

</body>
</html>
